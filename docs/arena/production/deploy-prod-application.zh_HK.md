# 最佳實踐

!!! NOTE
    - 以下是我們目前在生產環境中使用 Arena 的建議, 未來的更新版本將簡化此過程, 並允許在單個部署中進行合適的滾動更新.

## 在生產環境中使用 Arena 部署
以下是我們為 Arena Cloud 應用高性能伺服器部署推薦的兩種設計模式.

### A / B 伺服器部署
在此部署模式中, 需要創建兩個應用部署. 我們將它們命名為 ***MOBA A*** 和 ***MOBA B***. 在給定的伺服器流量時間內, 僅有一個部署處於連接狀態. 在此例中, 假設 MOBA A 是當前應用的部署. 這種模式要求您作為開發人員, 能夠動態地更新遊戲客戶端上指向的伺服器位址.

- **Maintenance Window Update (維護窗口更新):** 開始伺服器上沒有代碼, 因為您正處於遊戲的預定維護時段. 在這種情況下, 您將更新 ***MOBA A*** 上的遊戲服務代碼, 並重新啟動部署, 使更改生效. 由於沒有連接玩家, 因此不會中斷遊戲會話.

- **Critical Patch / Hot Fix Update (重要補丁 / 熱修補更新):** 發現一個可能影響遊戲平衡或導致某些客戶端不穩定的嚴重錯誤. 在這種情況下, 您希望更新遊戲代碼, 又不想終止正在進行的遊戲會話. 為此, 首先需要上傳並部署代碼更新到 ***MOBA B***. 確認更新已部署後, 更新入口伺服器把客戶端連接指向 ***MOBA B*** 的 URL. 新開的遊戲會使用更新的代碼和路由位址, 進行中的遊戲會話依然在 ***MOBA A*** 部署上正常完成.

!!! NOTE
    - 如果您選擇使用這種方法, 將優化計費以保證您只為活動部署付費. 此 A / B 模式中效率最低的一個部署不會被收取費用.


### 動態伺服器部署 (僅適用於 To Mars (TM) 及更高版本)
此部署模式可用於單個應用部署, 但是有一些限製. 此系統還需要我們的支持團隊設置自定義參數, 以確保其按預期工作, 請聯系 [support@lucidsight.com](mailto:support@lucidsight.com) 以了解更多信息, 並部署此服務. 在以下範例中, 我們將此部署稱為 ***MOBA SINGLE***.

- **Maintenance Window Update (維護窗口更新):** 開始伺服器上沒有代碼, 因為您正處於遊戲的預定維護時段. 在這種情況下, 您將在 ***MOBA SINGLE*** 上更新您的遊戲伺服器代碼, 並重新啟動部署以使更改生效. 由於沒有連接玩家, 因此不會中斷遊戲會話.

- **Critical Patch / Hot Fix Update (重要補丁 / 熱修補更新):** 發現一個可能影響遊戲平衡或導致某些客戶端不穩定的嚴重錯誤. 在這種情況下, 您希望更新新遊戲代碼, 又不想終止正在進行的遊戲會話. 為此, 您需要將代碼上傳到 ***MOBA SINGLE*** 應用. 在部署代碼時, 您 ***不能*** 選擇 *重新加載*, 直接選擇 "部署" 即可. 部署過程完成後, ***X*** 個新伺服器將被添加到您現有的伺服器池中, 並由 Arena 負載均衡器優先處理新流量. 新流量將自動被輸入最新的伺服器, 舊伺服器在 10 分鐘不活動後會自動縮小規模. ***X*** 可以是預定義的數量, 也可以等於正在工作中的伺服器數量.


