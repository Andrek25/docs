# 最佳实践

!!!注意   
    \- 以下是我们目前在生产环境中使用 Arena 的建议，未来的更新版本将简化此过程，并允许在单个部署中进行合适的滚动更新。

## 在生产中使用 Arena 部署
以下是我们为 Arena Cloud 应用高可用性服务器部署推荐的两种设计模式。

### A / B 服务器部署
在此部署模式中，需要创建两个应用部署。我们将它们命名为 {1>{2>MOBA A<2}<1} 和 {3>{4>MOBA B<4}<3}。在给定的服务器流量时间，仅有一个部署处于活动状态。在此示例中，假设 MOBA A 是当前使用的部署。此设置要求您作为开发人员，能够动态更新游戏客户端上的服务器地址。

- {1>Maintenance Window Update（维护时段更新）：<1}您的游戏服务器是空的，因为您正处于游戏的预定维护时段。在这种情况下，您将更新 {2>{3>MOBA A<3}<2} 上的游戏服务器代码，并重新启动部署，使更改生效。由于没有连接玩家，因此不会中断游戏会话。  

- {1>Critical Patch / Hot Fix Update（重要补丁 / 热修补更新）：<1}发现一个可能影响游戏平衡或导致某些客户端不稳定的严重错误。在这种情况下，您希望更新新游戏代码，而不终止正在进行的游戏会话。为此，首先需要上传并部署代码更改到 {2>{3>MOBA B<3}<2}。确认已部署更新后，可以更新后端服务以使用新的 {4>{5>MOBA B<5}<4} 连接 URL 更新游戏客户端。将使用更新的代码库路由和创建新游戏，旧游戏会话可以在 {6>{7>MOBA A<7}<6} 部署上正常完成其会话。

!!!注意   
    \- 如果您选择使用这种方法，将调整计费以确保您只为活动部署付费。此A / B 设置所需的最低空闲部署不会被收取额外费用。


### 动态服务器部署（仅适用于 To Mars (TM) 及更高版本）
此部署模式可用于单个应用部署，但是有一些限制。此系统还需要我们的支持团队设置自定义参数，以确保其按预期工作，请联系 {1>support@lucidsight.com<1}，了解更多信息，并部署此服务。在以下示例中，我们将此部署称为 {2>{3>MOBA SINGLE<3}<2}。

- {1>Maintenance Window Update（维护时段更新）：<1}您的游戏服务器是空的，因为您正处于游戏的预定维护时段。在这种情况下，您将在 {2>{3>MOBA SINGLE<3}<2} 上更新您的游戏服务器代码，并重新启动部署以使更改生效。由于没有连接玩家，因此不会中断游戏会话。  

- {1>Critical Patch / Hot Fix Update（重要补丁 / 热修补更新）：<1}发现一个可能影响游戏平衡或导致某些客户端不稳定的严重错误。在这种情况下，您希望更新新游戏代码，而不终止正在进行的游戏会话。为此，您需要将代码上传到 {2>{3>MOBA SINGLE<3}<2} 应用。在部署代码时，您{4>{5>不能<5}<4}选择{6>重新加载部署<6}，然后选择“部署”即可。部署过程完成后，{7>{8>X<8}<7} 个新服务器将被添加到您现有的服务器池中，并由 Arena 负载均衡器优先处理新流量。新流量将自动被输入最新的服务器，旧服务器在 10 分钟不活动后会缩小规模。{9>{10>X<10}<9} 可以是预定义的数量，或等于正在运行的服务器数量。


